(window.webpackJsonp=window.webpackJsonp||[]).push([[68,9,10,61],{574:function(t,e,r){"use strict";var o=r(4),n=r(405).trim;o({target:"String",proto:!0,forced:r(575)("trim")},{trim:function(){return n(this)}})},575:function(t,e,r){"use strict";var o=r(112).PROPER,n=r(6),c=r(406);t.exports=function(t){return n(function(){return!!c[t]()||"​᠎"!=="​᠎"[t]()||o&&c[t].name!==t})}},581:function(t,e,r){"use strict";r.r(e);r(33),r(403);var o={name:"Pagination",props:{meta:{type:Object,required:!0}},computed:{canPrev:function(){var t;return Number((null===(t=this.meta)||void 0===t?void 0:t.current_page)||1)>1},canNext:function(){var t,e;return Number((null===(t=this.meta)||void 0===t?void 0:t.current_page)||1)<Number((null===(e=this.meta)||void 0===e?void 0:e.last_page)||1)},pages:function(){var t,e,r=Number((null===(t=this.meta)||void 0===t?void 0:t.current_page)||1),o=Number((null===(e=this.meta)||void 0===e?void 0:e.last_page)||1),n=[];if(o<=7)for(var i=1;i<=o;i++)n.push(i);else{n.push(1),r>4&&n.push("…");for(var c=Math.max(2,r-1),l=Math.min(o-1,r+1),d=c;d<=l;d++)n.push(d);r<o-3&&n.push("…"),n.push(o)}return n}},methods:{go:function(p){var t;"…"!==p&&p!==(null===(t=this.meta)||void 0===t?void 0:t.current_page)&&this.$emit("change",p)}}},n=r(32),component=Object(n.a)(o,function(){var t=this,e=t._self._c;return e("nav",{staticClass:"flex items-center justify-center gap-1 mt-2",attrs:{role:"navigation","aria-label":"Էջավորում"}},[e("button",{staticClass:"px-2 py-1 mx-1 text-xs sm:text-sm font-medium rounded-lg border transition bg-indigo-50 text-neutral-700 border-indigo-200 hover:bg-indigo-100 disabled:opacity-50 disabled:cursor-not-allowed",attrs:{disabled:!t.canPrev},on:{click:function(e){return t.$emit("change",t.meta.current_page-1)}}},[t._v("\n    "+t._s(t.$t?t.$t("pagination.previous"):"Նախորդ")+"\n  ")]),t._v(" "),t._l(t.pages,function(p,i){return e("div",{key:"".concat(i,"-").concat(p)},["…"===p?e("span",{staticClass:"px-2 py-1 mx-1 text-xs sm:text-sm text-neutral-500"},[t._v("\n      …\n    ")]):e("button",{staticClass:"px-3 py-1 mx-1 text-xs sm:text-sm font-medium rounded-lg transition",class:p===t.meta.current_page?"bg-indigo-500 text-white shadow-sm":"bg-indigo-50 text-neutral-700 hover:bg-indigo-100 border border-indigo-200",on:{click:function(e){return t.go(p)}}},[t._v("\n      "+t._s(p)+"\n    ")])])}),t._v(" "),e("button",{staticClass:"px-2 py-1 mx-1 text-xs sm:text-sm font-medium rounded-lg border transition bg-indigo-50 text-neutral-700 border-indigo-200 hover:bg-indigo-100 disabled:opacity-50 disabled:cursor-not-allowed",attrs:{disabled:!t.canNext},on:{click:function(e){return t.$emit("change",t.meta.current_page+1)}}},[t._v("\n    "+t._s(t.$t?t.$t("pagination.next"):"Հաջորդ")+"\n  ")])],2)},[],!1,null,null,null);e.default=component.exports},621:function(t,e,r){var content=r(648);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(57).default)("09563ce8",content,!0,{sourceMap:!1})},622:function(t,e,r){var content=r(650);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(57).default)("7b96aa63",content,!0,{sourceMap:!1})},647:function(t,e,r){"use strict";r(621)},648:function(t,e,r){var o=r(56)(function(i){return i[1]});o.push([t.i,".card[data-v-a28e6736]{border-radius:1rem;border-width:1px;--tw-border-opacity:1;border-color:#e5e7eb;border-color:rgba(229,231,235,var(--tw-border-opacity,1));--tw-bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity,1));--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:0 0 transparent,0 0 transparent,0 1px 2px 0 rgba(0,0,0,.05);box-shadow:var(--tw-ring-offset-shadow,0 0 transparent),var(--tw-ring-shadow,0 0 transparent),var(--tw-shadow)}.card[data-v-a28e6736]:hover{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color);box-shadow:0 0 transparent,0 0 transparent,0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);box-shadow:var(--tw-ring-offset-shadow,0 0 transparent),var(--tw-ring-shadow,0 0 transparent),var(--tw-shadow)}.dark .card[data-v-a28e6736]{--tw-border-opacity:1;background-color:#111827;background-color:rgba(17,24,39,var(--tw-bg-opacity,1));border-color:#1f2937;border-color:rgba(31,41,55,var(--tw-border-opacity,1))}.btn-view[data-v-a28e6736],.dark .card[data-v-a28e6736]{--tw-bg-opacity:1}.btn-view[data-v-a28e6736]{background-color:#f0f5ff;background-color:rgba(240,245,255,var(--tw-bg-opacity,1));border-radius:.5rem;font-size:.75rem;font-weight:500;line-height:1rem;padding:.5rem 1rem;--tw-text-opacity:1;color:#5850ec;color:rgba(88,80,236,var(--tw-text-opacity,1));transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.btn-view[data-v-a28e6736]:hover{--tw-bg-opacity:1;background-color:#e5edff;background-color:rgba(229,237,255,var(--tw-bg-opacity,1))}.dark .btn-view[data-v-a28e6736]{background-color:rgba(54,47,120,.4);--tw-text-opacity:1;color:#8da2fb;color:rgba(141,162,251,var(--tw-text-opacity,1))}.dark .btn-view[data-v-a28e6736]:hover{--tw-bg-opacity:1;background-color:#42389d;background-color:rgba(66,56,157,var(--tw-bg-opacity,1))}.badge[data-v-a28e6736]{border-radius:9999px}",""]),o.locals={},t.exports=o},649:function(t,e,r){"use strict";r(622)},650:function(t,e,r){var o=r(56)(function(i){return i[1]});o.push([t.i,".input-style[data-v-435ab0bb]{border-radius:.75rem;border-width:1px;--tw-border-opacity:1;border-color:#d1d5db;border-color:rgba(209,213,219,var(--tw-border-opacity,1));--tw-bg-opacity:1;background-color:#f9fafb;background-color:rgba(249,250,251,var(--tw-bg-opacity,1));font-size:.875rem;line-height:1.25rem;outline:2px solid transparent;outline-offset:2px;padding:.625rem 1rem;transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.input-style[data-v-435ab0bb]:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),0 0 transparent;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 transparent);--tw-ring-opacity:1;--tw-ring-color:rgba(104,117,245,var(--tw-ring-opacity,1))}.dark .input-style[data-v-435ab0bb]{--tw-border-opacity:1;border-color:#374151;border-color:rgba(55,65,81,var(--tw-border-opacity,1));--tw-bg-opacity:1;background-color:#1f2937;background-color:rgba(31,41,55,var(--tw-bg-opacity,1))}",""]),o.locals={},t.exports=o},687:function(t,e,r){var content=r(728);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(57).default)("32118a12",content,!0,{sourceMap:!1})},707:function(t,e,r){"use strict";r.r(e);r(17),r(38),r(8),r(28),r(52);var o={props:{order:{type:Object,required:!0}},computed:{factoryOrders:function(){return this.order.factory_orders||[]},factoryCount:function(){return this.factoryOrders.length},finishDate:function(){var t;return null!==(t=this.order.dates)&&void 0!==t&&t.finish_date?new Date(this.order.dates.finish_date):null},hasCanceled:function(){var t=this;return this.factoryOrders.some(function(e){return"canceled"===t.normalizeStatus(e.status)})},hasDateChanged:function(){var t=this;return this.factoryOrders.some(function(e){return"date_changed"===t.normalizeStatus(e.status)})},isAllCompleted:function(){var t=this,e=this.factoryOrders;return!!e.length&&e.every(function(e){var code=t.normalizeStatus(e.status);return"canceled"!==code&&(("finished"===code||"confirmed"===code)&&!!e.admin_confirmation_date)})},isOverdue:function(){return this.finishDate&&this.finishDate<new Date&&!this.isAllCompleted&&!this.hasCanceled},isNearDeadline:function(){if(!this.finishDate||this.isAllCompleted)return!1;var t=(this.finishDate-Date.now())/36e5;return t>0&&t<=24},isInProgress:function(){return this.factoryOrders.length>0&&!this.isAllCompleted&&!this.hasCanceled},overallStatusText:function(){return this.hasCanceled?"Չեղարկված":this.hasDateChanged?"Ժամկետը փոփոխված":this.isAllCompleted?"Ավարտված":this.isOverdue?"Ժամկետն անցել է":this.isInProgress||this.factoryOrders.length>0?"Ընթացքում":"Սպասում է"},overallStatusClass:function(){return this.hasCanceled?"bg-rose-600 text-white":this.hasDateChanged?"bg-orange-500 text-white":this.isAllCompleted?"bg-emerald-600 text-white":this.isOverdue?"bg-red-600 text-white":this.isInProgress?"bg-amber-600 text-white":"bg-gray-500 text-white"}},methods:{normalizeStatus:function(t){if(!t)return"pending";var s=t.toString().toLowerCase();return"finished"===s||s.includes("ավարտ")?"finished":"canceled"===s||"cancelled"===s||s.includes("մերժ")?"canceled":"confirmed"===s||s.includes("հաստատ")?"confirmed":"date_changed"===s||s.includes("ժամկետ")?"date_changed":"pending"===s||"0"===s||"null"===s||"-"===s?"pending":s},formatDeadline:function(t){if(!t)return"—";var e=new Date(t),r=Math.floor((e-Date.now())/864e5);return r<0?"Անցել է":0===r?"Այսօր":1===r?"Վաղը":"".concat(r," օր հետո")}}},n=(r(647),r(32)),component=Object(n.a)(o,function(){var t,e,r,o,n,c=this,l=c._self._c;return l("div",{staticClass:"card p-5 relative overflow-hidden group transition-all duration-300",class:{"ring-4 ring-red-500/30 ring-offset-2 ring-offset-transparent shadow-red-500/10":c.isOverdue,"ring-3 ring-orange-500/30":c.isNearDeadline&&!c.isOverdue}},[c.isOverdue?l("div",{staticClass:"pointer-events-none absolute inset-0 bg-gradient-to-br from-red-500/10 to-transparent"}):c._e(),c._v(" "),l("div",{staticClass:"flex items-start justify-between gap-3 mb-3"},[l("div",{staticClass:"space-y-1 flex-1"},[l("p",{staticClass:"text-xs text-gray-500 dark:text-gray-400"},[c._v("\n        #"+c._s(null!==(t=null===(e=c.order.order_number)||void 0===e?void 0:e.number)&&void 0!==t?t:c.order.id)+"\n      ")]),c._v(" "),l("h3",{staticClass:"text-base font-semibold text-gray-900 dark:text-white line-clamp-2"},[c._v("\n        "+c._s(c.order.name||"Անվանում չկա")+"\n      ")])]),c._v(" "),l("span",{staticClass:"badge flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold",class:c.overallStatusClass},[c.isOverdue?l("span",{staticClass:"w-2 h-2 rounded-full bg-white animate-pulse"}):c._e(),c._v("\n      "+c._s(c.overallStatusText)+"\n    ")])]),c._v(" "),l("dl",{staticClass:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs text-gray-600 dark:text-gray-300"},[l("div",[l("dt",{staticClass:"text-gray-500"},[c._v("Prefix")]),c._v(" "),l("dd",{staticClass:"font-medium"},[c._v(c._s(null!==(r=null===(o=c.order.prefix_code)||void 0===o?void 0:o.code)&&void 0!==r?r:"—"))])]),c._v(" "),l("div",[l("dt",{staticClass:"text-gray-500"},[c._v("Ստեղծվել")]),c._v(" "),l("dd",[c._v(c._s(c.order.created_at))])]),c._v(" "),l("div",[l("dt",{staticClass:"text-gray-500"},[c._v("Ավարտ")]),c._v(" "),l("dd",{class:{"text-red-600 font-bold":c.isOverdue||c.isNearDeadline}},[c._v("\n        "+c._s(c.formatDeadline(null===(n=c.order.dates)||void 0===n?void 0:n.finish_date))+"\n      ")])]),c._v(" "),c.factoryCount?l("div",{staticClass:"col-span-2"},[l("dt",{staticClass:"text-gray-500"},[c._v("Գործարաններ")]),c._v(" "),l("dd",{staticClass:"font-medium"},[c._v(c._s(c.factoryCount)+" գործարան")])]):c._e()]),c._v(" "),l("div",{staticClass:"flex items-center justify-between pt-3 mt-4 border-t border-gray-200 dark:border-gray-700"},[l("button",{staticClass:"btn-view",on:{click:function(t){return c.$emit("edit",c.order)}}},[c._v("Դիտել")])])])},[],!1,null,"a28e6736",null);e.default=component.exports},708:function(t,e,r){"use strict";r.r(e);r(23),r(49),r(17),r(8),r(18),r(78),r(24),r(39),r(40),r(27),r(30);var o=r(1),n=r(15);r(9),r(403);function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)}return r}var l={components:{Pagination:r(581).default},props:{total:Number,filtered:Number,pagination:Object,selectedFactory:Object,operators:{type:Array,default:function(){return[]}}},data:function(){return{localFilters:{search:"",overallStatus:null,operatorId:null,timeRange:null,factoryStatus:null},factoryStatuses:[],localFactory:this.selectedFactory||null}},watch:{localFilters:{deep:!0,handler:function(){this.$emit("update:filters",function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach(function(e){Object(n.a)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},this.localFilters))}},localFactory:function(t){this.$emit("update:factory",t)},selectedFactory:{immediate:!0,handler:function(t){this.localFactory=t||null,this.localFilters.operatorId=null}}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.fetchFactoryStatuses();case 1:case"end":return e.stop()}},e)}))()},methods:{fetchFactoryStatuses:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,t.$axios.get("/api/factories/factory-order-filters");case 1:r=e.sent,t.factoryStatuses=r.data,e.next=3;break;case 2:e.prev=2,o=e.catch(0),console.error("Failed to load factory statuses",o);case 3:case"end":return e.stop()}},e,null,[[0,2]])}))()}}},d=l,f=(r(649),r(32)),component=Object(f.a)(d,function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col lg:flex-row gap-5 mb-6 bg-white dark:bg-gray-900 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 p-5"},[e("div",{staticClass:"flex-1 space-y-4"},[t._m(0),t._v(" "),e("div",{staticClass:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.localFilters.search,expression:"localFilters.search"}],staticClass:"input-style",attrs:{type:"text",placeholder:"Որոնել..."},domProps:{value:t.localFilters.search},on:{input:function(e){e.target.composing||t.$set(t.localFilters,"search",e.target.value)}}}),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.localFilters.factoryStatus,expression:"localFilters.factoryStatus"}],staticClass:"input-style",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.localFilters,"factoryStatus",e.target.multiple?r:r[0])}}},[e("option",{domProps:{value:null}},[t._v("Գործարանի ստատուսները")]),t._v(" "),t._l(t.factoryStatuses,function(r,o){return e("option",{key:o,domProps:{value:r.value}},[t._v("\n          "+t._s(r.label)+"\n        ")])})],2),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.localFilters.operatorId,expression:"localFilters.operatorId"}],staticClass:"input-style",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.localFilters,"operatorId",e.target.multiple?r:r[0])}}},[e("option",{domProps:{value:null}},[t._v("Բոլոր օպերատորները")]),t._v(" "),t._l(t.operators,function(r){return e("option",{key:r.id,domProps:{value:r.id}},[t._v("\n          "+t._s(r.name)+"\n          "),r.factory_name?e("span",[t._v(" — "+t._s(r.factory_name))]):t._e()])})],2),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.localFilters.timeRange,expression:"localFilters.timeRange"}],staticClass:"input-style",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.localFilters,"timeRange",e.target.multiple?r:r[0])}}},[e("option",{domProps:{value:null}},[t._v("Բոլոր ժամկետները")]),t._v(" "),e("option",{attrs:{value:"today"}},[t._v("Այսօր")]),t._v(" "),e("option",{attrs:{value:"tomorrow"}},[t._v("Վաղը")]),t._v(" "),e("option",{attrs:{value:"this_week"}},[t._v("Այս շաբաթ")]),t._v(" "),e("option",{attrs:{value:"overdue"}},[t._v("Ժամկետն անցած")]),t._v(" "),e("option",{attrs:{value:"no_deadline"}},[t._v("Առանց ժամկետի")])])]),t._v(" "),e("p",{staticClass:"text-sm text-gray-600 dark:text-gray-400"},[t._v("\n      Ընդհանուր՝ "),e("strong",[t._v(t._s(t.total))]),t._v(" "),t.filtered<t.total?e("span",[t._v("\n        | Ցուցադրվում է՝ "),e("strong",[t._v(t._s(t.filtered))])]):t._e()])]),t._v(" "),t.pagination&&t.pagination.last_page>1?e("div",{staticClass:"flex items-end"},[e("Pagination",{attrs:{meta:t.pagination},on:{change:function(e){return t.$emit("change-page",e)}}})],1):t._e()])},[function(){var t=this._self._c;return t("div",{staticClass:"flex items-center justify-between"},[t("h1",{staticClass:"text-2xl font-bold text-gray-900 dark:text-white"},[this._v("\n        Պատվերներ\n      ")])])}],!1,null,"435ab0bb",null);e.default=component.exports},727:function(t,e,r){"use strict";r(687)},728:function(t,e,r){var o=r(56)(function(i){return i[1]});o.push([t.i,".fade-enter-active[data-v-641e4b52],.fade-leave-active[data-v-641e4b52]{transition:opacity .25s ease}.fade-enter[data-v-641e4b52],.fade-leave-to[data-v-641e4b52]{opacity:0}.slide-in-center-enter-active[data-v-641e4b52],.slide-in-center-leave-active[data-v-641e4b52]{transition:transform .35s cubic-bezier(.4,0,.2,1)}.slide-in-center-enter[data-v-641e4b52],.slide-in-center-leave-to[data-v-641e4b52]{transform:translateX(100%)}.animate-fade-in[data-v-641e4b52]{animation:fadeIn-641e4b52 .5s ease-out}@keyframes fadeIn-641e4b52{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}",""]),o.locals={},t.exports=o},777:function(t,e,r){"use strict";r.r(e);r(17),r(39),r(40),r(27);var o=r(1),n=r(184),c=r(15),l=(r(9),r(24),r(43),r(23),r(44),r(38),r(414),r(403),r(8),r(18),r(28),r(52),r(25),r(78),r(574),r(415),r(416),r(417),r(418),r(419),r(420),r(421),r(422),r(423),r(424),r(425),r(426),r(427),r(30),r(26),r(96)),d=r(707),f=r(708),v=r(769);function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach(function(e){Object(c.a)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var y={name:"AdminOrdersPage",components:{OrderCard:d.default,OrdersToolbar:f.default,OrderDetail:v.default},layout:"admin",middleware:["role-guard"],meta:{role:"admin"},data:function(){return{selectedOrder:null,selectedFactory:null,filters:{search:"",overallStatus:null,operatorId:null,timeRange:null,factoryStatus:null}}},computed:m(m(m({},Object(l.c)("orders",["orders","getPagination"])),Object(l.c)("factory",["getFactory"])),{},{allOrders:function(){return this.orders||[]},pagination:function(){return this.getPagination},operatorOptions:function(){var t=this,e=new Map;return this.allOrders.forEach(function(r){(r.factory_orders||[]).forEach(function(r){var o;r.operator_id&&r.operator&&(t.selectedFactory&&r.factory_id!==t.selectedFactory.id||e.has(r.operator_id)||e.set(r.operator_id,{id:r.operator_id,name:r.operator.name,factory_id:r.factory_id,factory_name:(null===(o=r.factory)||void 0===o?void 0:o.name)||""}))})}),Array.from(e.values())},searchFilter:function(){var t,e=this,r=Object(n.a)(this.allOrders);if(this.selectedFactory&&(r=r.filter(function(t){var r;return null===(r=t.factory_orders)||void 0===r?void 0:r.some(function(t){return t.factory_id===e.selectedFactory.id})})),null!==(t=this.filters.search)&&void 0!==t&&t.trim()){var o=this.filters.search.toLowerCase().trim();r=r.filter(function(t){var e,r;return((null===(e=t.order_number)||void 0===e?void 0:e.number)||"").toLowerCase().includes(o)||(t.name||"").toLowerCase().includes(o)||(t.description||"").toLowerCase().includes(o)||((null===(r=t.prefix_code)||void 0===r?void 0:r.code)||"").toLowerCase().includes(o)})}if(this.filters.timeRange){var c=new Date,l=new Date;l.setHours(0,0,0,0);var d=new Date(l);d.setDate(d.getDate()+1),r=r.filter(function(t){var r,o=null!==(r=t.dates)&&void 0!==r&&r.finish_date?new Date(t.dates.finish_date):null;switch(e.filters.timeRange){case"no_deadline":return!o;case"overdue":return o&&o<c&&!e.isOrderCompleted(t);case"today":return o&&o.toDateString()===(new Date).toDateString();case"tomorrow":return o&&o.getTime()>=d.setHours(0,0,0,0)&&o.getTime()<d.setHours(24,0,0,0);case"this_week":var n=new Date(l);return n.setDate(n.getDate()+7),o&&o>=c&&o<=n;default:return!0}})}if(this.filters.factoryStatus&&(r=r.filter(function(t){var r;return null===(r=t.factory_orders)||void 0===r?void 0:r.some(function(t){return t.status===e.filters.factoryStatus})})),this.filters.operatorId){var f=Number(this.filters.operatorId);r=r.filter(function(t){var e;return null===(e=t.factory_orders)||void 0===e?void 0:e.some(function(t){return t.operator_id===f})})}return r}}),created:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.fetchFactory();case 1:return e.next=2,t.fetchOrders({page:1,perPage:30});case 2:case"end":return e.stop()}},e)}))()},methods:m(m(m({},Object(l.b)("orders",["fetchOrders"])),Object(l.b)("factory",["fetchFactory"])),{},{isOrderCompleted:function(t){var e=t.factory_orders||[];return 0!==e.length&&e.every(function(t){var s=(t.status||"").toString().toLowerCase();return!!["canceled","չեղարկ","merjel","отмен"].some(function(t){return s.includes(t)})||["completed","confirmed","done","готово","завершено","ավարտել","hastatel"].some(function(t){return s.includes(t)})&&!!t.admin_confirmation_date})},updateFilters:function(t){this.filters=m(m({},this.filters),t)},handleSaved:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.fetchOrders({page:(null===(r=t.pagination)||void 0===r?void 0:r.current_page)||1});case 1:t.closeEditModal();case 2:case"end":return e.stop()}},e)}))()},editOrder:function(t){this.selectedOrder=m({},t)},closeEditModal:function(){this.selectedOrder=null},changePage:function(t){var e;this.fetchOrders({page:t,perPage:(null===(e=this.pagination)||void 0===e?void 0:e.per_page)||30}),this.closeEditModal()}})},w=(r(727),r(32)),component=Object(w.a)(y,function(){var t=this,e=t._self._c;return e("main",{staticClass:"min-h-screen bg-gray-50 dark:bg-gray-950 py-6 px-4 sm:px-6 lg:px-8"},[e("div",{staticClass:"max-w-7xl mx-auto space-y-6"},[e("orders-toolbar",{attrs:{total:t.allOrders.length,filtered:t.searchFilter.length,pagination:t.pagination,"selected-factory":t.selectedFactory,operators:t.operatorOptions},on:{"update:filters":t.updateFilters,"update:factory":function(e){t.selectedFactory=e},"change-page":t.changePage}}),t._v(" "),t.searchFilter.length?e("div",{staticClass:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6 animate-fade-in"},t._l(t.searchFilter,function(r){return e("order-card",{key:r.id,attrs:{order:r},on:{edit:t.editOrder}})}),1):e("div",{staticClass:"flex flex-col items-center justify-center py-16 bg-white dark:bg-gray-900 rounded-2xl shadow-md border border-dashed border-gray-300 dark:border-gray-700"},[e("p",{staticClass:"text-lg font-medium text-gray-700 dark:text-gray-200 mb-2"},[t._v("\n        "+t._s(t.selectedFactory?"«".concat(t.selectedFactory.name,"» գործարանում պատվերներ չեն գտնվել"):"Պատվերներ չեն գտնվել")+"\n      ")]),t._v(" "),e("p",{staticClass:"text-sm text-gray-500 dark:text-gray-400 text-center max-w-md"},[t._v("\n        Փորձեք փոխել ֆիլտրերը կամ ընտրել այլ գործարան\n      ")])]),t._v(" "),e("transition",{attrs:{name:"fade"}},[t.selectedOrder?e("div",{staticClass:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeEditModal.apply(null,arguments)}}},[e("transition",{attrs:{name:"slide-in-center"}},[t.selectedOrder?e("div",{staticClass:"h-full w-full max-w-5xl bg-white dark:bg-gray-900 shadow-2xl flex flex-col overflow-hidden"},[e("order-detail",{attrs:{order:t.selectedOrder},on:{close:t.closeEditModal,saved:t.handleSaved}})],1):t._e()])],1):t._e()])],1)])},[],!1,null,"641e4b52",null);e.default=component.exports}}]);