(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{598:function(e,t,r){"use strict";var n=r(4),o=r(655);n({target:"String",proto:!0,forced:r(656)("sub")},{sub:function(){return o(this,"sub","","")}})},655:function(e,t,r){"use strict";var n=r(5),o=r(34),c=r(19),l=/"/g,h=n("".replace);e.exports=function(e,t,r,n){var d=c(o(e)),f="<"+t;return""!==r&&(f+=" "+r+'="'+h(c(n),l,"&quot;")+'"'),f+">"+d+"</"+t+">"}},656:function(e,t,r){"use strict";var n=r(6);e.exports=function(e){return n(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})}},804:function(e,t,r){"use strict";r.r(t);var n=r(1),o=(r(49),r(8),r(598),r(30),r(9),r(570)),c=r(589),l=r(597),h={props:{dxfUrl:String},data:function(){return{scene:null,camera:null,renderer:null,dxfGroup:null,error:null}},watch:{dxfUrl:"loadDxfFile"},mounted:function(){this.initThreeJS(),this.loadDxfFile(),window.addEventListener("resize",this.resize)},beforeDestroy:function(){window.removeEventListener("resize",this.resize),this.cleanupThreeJS()},methods:{initThreeJS:function(){this.scene=new o.ld,this.camera=new o.lc(60,1,.1,1e3),this.renderer=new c.a({canvas:this.$refs.canvas,antialias:!0,alpha:!0}),this.renderer.setClearColor(16777215,1),this.resize()},resize:function(){var rect=this.$refs.canvas.getBoundingClientRect();this.renderer.setSize(rect.width,rect.height),this.camera.aspect=rect.width/rect.height,this.camera.updateProjectionMatrix()},loadDxfFile:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark(function t(){var r,data,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.error=null,t.next=1,e.$axios.get("/api/factories/getFile/".concat(e.dxfUrl));case 1:r=t.sent,data=r.data,n=atob(data.content),e.parseDxf(n),t.next=3;break;case 2:t.prev=2,t.catch(0),e.error="DXF-ը բեռնելիս սխալ";case 3:case"end":return t.stop()}},t,null,[[0,2]])}))()},parseDxf:function(text){var e,t=this,r=(new l.a).parseSync(text);null!=r&&null!==(e=r.entities)&&void 0!==e&&e.length&&(this.dxfGroup&&this.scene.remove(this.dxfGroup),this.dxfGroup=new o.hb,r.entities.forEach(function(e){if("LINE"===e.type){var r=e.vertices.map(function(e){return new o.Jd(e.x,e.y,0)}),n=(new o.p).setFromPoints(r),line=new o.pb(n,new o.qb({color:0}));t.dxfGroup.add(line)}}),this.scene.add(this.dxfGroup),this.fitToView(),this.renderer.render(this.scene,this.camera))},fitToView:function(){var e=(new o.m).setFromObject(this.dxfGroup),t=e.getCenter(new o.Jd),r=e.getSize(new o.Jd);this.dxfGroup.position.sub(t);var n=(Math.max(r.x,r.y)||1)/(2*Math.tan(this.camera.fov*Math.PI/360));this.camera.position.set(0,0,1.5*n),this.camera.lookAt(0,0,0)},cleanupThreeJS:function(){var e,t,r;null===(e=this.renderer)||void 0===e||e.dispose(),null===(t=this.scene)||void 0===t||t.clear(),null===(r=this.dxfGroup)||void 0===r||r.clear()}}},d=r(32),component=Object(d.a)(h,function(){var e=this,t=e._self._c;return t("div",{staticClass:"relative w-full h-full bg-gray-50 dark:bg-gray-900 rounded-lg overflow-hidden"},[t("canvas",{ref:"canvas",staticClass:"w-full h-full"}),e._v(" "),e.error?t("div",{staticClass:"absolute inset-0 flex items-center justify-center bg-white/90 dark:bg-black/90 p-4"},[t("p",{staticClass:"text-red-600 dark:text-red-400 text-center"},[e._v(e._s(e.error))])]):e._e()])},[],!1,null,null,null);t.default=component.exports}}]);