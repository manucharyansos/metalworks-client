(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{432:function(t,e,n){var content=n(449);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("43d63d3c",content,!0,{sourceMap:!1})},437:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(128);var l=n(172),o=n(100);function c(t){return function(t){if(Array.isArray(t))return Object(r.a)(t)}(t)||Object(l.a)(t)||Object(o.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},448:function(t,e,n){"use strict";n(432)},449:function(t,e,n){var r=n(26)(function(i){return i[1]});r.push([t.i,".transition-colors[data-v-4817113e]{transition-duration:.15s;transition-property:background-color,border-color,color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.sticky[data-v-4817113e]{position:sticky;z-index:10}.line-through[data-v-4817113e]{-webkit-text-decoration:line-through;text-decoration:line-through}",""]),r.locals={},t.exports=r},498:function(t,e,n){"use strict";n.r(e);n(80),n(18),n(97);var r=n(437),l=n(20);n(29),n(54),n(43),n(25),n(256),n(423),n(49),n(424),n(253),n(39),n(47),n(48),n(10),n(465),n(30),n(466),n(467),n(468),n(469),n(470),n(471),n(472),n(473),n(474),n(475),n(476),n(477),n(478),n(479),n(480),n(481),n(38),n(35);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){Object(l.a)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var d={name:"ShowFiles",props:{pmps:{type:Object,default:function(){return{exists:!1}}},factories:{type:Array,default:function(){return[]}},autoOpenFactoryId:{type:[String,Number],default:null},selectedFiles:{type:Array,default:function(){return[]}},fileQuantities:{type:Object,default:function(){return{}}},isEditingMode:{type:Boolean,default:!1}},data:function(){return{selectedFactory:null}},computed:{factoriesWithCount:function(){var t=this;return this.factories.map(function(e){var n=t.pmps.exists?t.pmps.pmp.files.filter(function(t){return t.path.includes("/".concat(e.value,"/"))}).length:0;return c(c({},e),{},{fileCount:n})})},allSelected:function(){var t=this;if(!this.pmps.exists||!this.selectedFactory)return!1;var e=this.pmps.pmp.remote_number.flatMap(function(e){return t.getFactoryFiles(e.id)});return e.length>0&&this.selectedFiles.length===e.length},areQuantitiesValid:function(){var t=this;return this.selectedFiles.every(function(e){return t.isQuantityValid(e)})}},mounted:function(){var t=this;if(this.autoOpenFactoryId){var e=this.factoriesWithCount.find(function(e){return e.id===t.autoOpenFactoryId});e&&e.fileCount>0&&this.selectFactory(e)}else{var n=this.factoriesWithCount.find(function(t){return t.fileCount>0});n&&this.selectFactory(n)}},methods:{selectFactory:function(t){this.selectedFactory=t},getFactoryFiles:function(t){var e=this;return this.pmps.exists?this.pmps.pmp.files.filter(function(n){var r=n.path.includes("/".concat(e.selectedFactory.value,"/"));return n.remote_number_id===t&&r}):[]},toggleFileSelection:function(t){var e=Object(r.a)(this.selectedFiles),n=c({},this.fileQuantities);e.includes(t)?(e=e.filter(function(e){return e!==t}),delete n[t]):(e.push(t),n[t]=1),this.$emit("update:selectedFiles",e),this.$emit("update:fileQuantities",n)},updateQuantity:function(t,e){var n=c(c({},this.fileQuantities),{},Object(l.a)({},t,Number(e)));this.$emit("update:fileQuantities",n)},toggleSelectAll:function(){var t=this,e=Object(r.a)(this.selectedFiles),n=c({},this.fileQuantities);if(this.allSelected){var l=this.pmps.pmp.remote_number.flatMap(function(e){return t.getFactoryFiles(e.id).map(function(t){return t.id})});e=e.filter(function(t){return!l.includes(t)}),l.forEach(function(t){delete n[t]})}else{var o=this.pmps.pmp.remote_number.flatMap(function(e){return t.getFactoryFiles(e.id)}).map(function(t){return t.id});e=Object(r.a)(new Set([].concat(Object(r.a)(e),Object(r.a)(o)))),o.forEach(function(t){n[t]||(n[t]=1)})}this.$emit("update:selectedFiles",e),this.$emit("update:fileQuantities",n)},isQuantityValid:function(t){var e=this.fileQuantities[t];return void 0!==e&&e>0},submitSelectedFiles:function(){var t=this;if(this.areQuantitiesValid){var e=this.pmps.pmp.files.filter(function(e){return t.selectedFiles.includes(e.id)}).map(function(e){return c(c({},e),{},{quantity:t.fileQuantities[e.id]})});this.$emit("files-selected",e);var n={};this.pmps.pmp.files.forEach(function(e){t.selectedFiles.includes(e.id)&&(n[e.factory_id]||(n[e.factory_id]=[]),n[e.factory_id].push({id:e.id,quantity:t.fileQuantities[e.id]}))}),Object.keys(n).forEach(function(e){var data={user_id:t.$parent.selectedClient.id,creator_id:t.$auth.user.id,name:"".concat(t.$parent.selectedPmp.group,".").concat(t.$parent.selectedPmpRemoteNumber),description:t.$parent.description,status:"pending",finish_date:t.$parent.finishDate,remote_number_id:t.$parent.remote_number_id,pmp_id:t.$parent.selectedPmp.id,link_existing_files:t.$parent.link_existing_files,factory_id:e,selected_files:n[e]};t.$emit("factory-files-selected",data)}),this.$emit("back")}else this.$notify({text:"Խնդրում ենք մուտքագրել վավեր քանակ բոլոր ընտրված ֆայլերի համար (քանակը պետք է լինի > 0):",duration:3e3,speed:1e3,position:"top",type:"error"})}}},f=(n(448),n(8)),component=Object(f.a)(d,function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-4 bg-white rounded-lg shadow-md"},[t.selectedFactory?e("div",[e("button",{staticClass:"mb-4 flex items-center text-blue-600 hover:text-blue-800",on:{click:function(e){t.selectedFactory=null}}},[e("svg",{staticClass:"h-5 w-5 mr-1",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z","clip-rule":"evenodd"}})]),t._v("\n      Վերադառնալ արտադրամասերի ցանկին\n    ")]),t._v(" "),t.pmps.exists?e("div",{staticClass:"space-y-6"},[e("div",{staticClass:"p-4 bg-gray-50 rounded-md"},[e("h2",{staticClass:"text-2xl font-bold text-gray-800"},[t._v("\n          Խումբ: "+t._s(t.pmps.pmp.group)+" - "+t._s(t.pmps.pmp.group_name)+"\n        ")]),t._v(" "),e("div",{staticClass:"mt-2 flex items-center justify-between"},[e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"bg-green-100 px-3 py-1 rounded-full text-green-800 flex items-center"},[e("svg",{staticClass:"h-4 w-4 mr-1",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"}})]),t._v(" "),e("span",{staticClass:"text-sm font-medium"},[t._v(t._s(t.selectedFactory.name))])])]),t._v(" "),e("button",{staticClass:"text-sm text-blue-600 hover:text-blue-800",on:{click:t.toggleSelectAll}},[t._v("\n            "+t._s(t.allSelected?"Չեղարկել բոլորը":"Ընտրել բոլորը")+"\n          ")])])]),t._v(" "),t._l(t.pmps.pmp.remote_number,function(n){return e("div",{key:n.id,staticClass:"pl-4 border-l-4 border-blue-200"},[e("h3",{staticClass:"text-xl font-semibold text-gray-700"},[t._v("\n          Հեռակա համար: "+t._s(n.remote_number)+" -\n          "+t._s(n.remote_number_name)+"\n        ")]),t._v(" "),e("div",{staticClass:"mt-4 space-y-3"},[t._l(t.getFactoryFiles(n.id),function(n){return e("div",{key:n.id,staticClass:"p-3 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",class:{"bg-blue-50 border border-blue-200":t.selectedFiles.includes(n.id)}},[e("div",{staticClass:"flex items-start"},[e("input",{staticClass:"mt-1 h-4 w-4 text-blue-600 rounded focus:ring-blue-500",attrs:{id:"file_"+n.id,type:"checkbox"},domProps:{checked:t.selectedFiles.includes(n.id)},on:{change:function(e){return t.toggleFileSelection(n.id)}}}),t._v(" "),e("div",{staticClass:"ml-3 flex-1"},[e("label",{staticClass:"cursor-pointer",attrs:{for:"file_"+n.id}},[e("p",{staticClass:"font-medium text-blue-600 flex items-center"},[e("svg",{staticClass:"h-5 w-5 mr-2 text-gray-400",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"}})]),t._v("\n                    "+t._s(n.original_name)+"\n                  ")]),t._v(" "),e("p",{staticClass:"text-sm text-gray-600 ml-7 mt-1"},[t._v("\n                    "+t._s(n.path)+"\n                  ")])]),t._v(" "),t.selectedFiles.includes(n.id)?e("div",{staticClass:"mt-2 ml-7"},[e("label",{staticClass:"text-sm text-gray-600",attrs:{for:"quantity_"+n.id}},[t._v("\n                    Քանակ *\n                  ")]),t._v(" "),e("input",{staticClass:"w-24 p-1 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",class:{"border-red-500":!t.isQuantityValid(n.id)},attrs:{id:"quantity_"+n.id,type:"number",min:"1",required:"",placeholder:"1"},domProps:{value:t.fileQuantities[n.id]},on:{input:function(e){return t.updateQuantity(n.id,e.target.value)}}}),t._v(" "),t.isQuantityValid(n.id)?t._e():e("p",{staticClass:"text-red-500 text-xs mt-1"},[t._v("\n                    Քանակը պետք է լինի 1 կամ ավելի\n                  ")]),t._v(" "),t.isEditingMode&&n.quantity?e("p",{staticClass:"text-sm text-gray-600 mt-1"},[e("span",{staticClass:"line-through"},[t._v(t._s(n.quantity))]),t._v("\n                    → "+t._s(t.fileQuantities[n.id]||1)+"\n                  ")]):t._e()]):t._e()]),t._v(" "),e("div",{staticClass:"text-right"},[n.quantity?e("span",{staticClass:"block text-green-700"},[t._v("\n                  Քանակ: "+t._s(n.quantity)+"\n                ")]):t._e(),t._v(" "),n.material_type?e("span",{staticClass:"block text-purple-700"},[t._v("\n                  Նյութ: "+t._s(n.material_type)+"\n                ")]):t._e(),t._v(" "),n.thickness?e("span",{staticClass:"block text-orange-700"},[t._v("\n                  Հաստություն: "+t._s(n.thickness)+"\n                ")]):t._e()])])])}),t._v(" "),0===t.getFactoryFiles(n.id).length?e("div",{staticClass:"p-3 text-center text-gray-500"},[t._v("\n            Ֆայլեր չեն գտնվել այս հեռակա համարի համար\n          ")]):t._e()],2)])})],2):e("div",{staticClass:"p-4 text-center text-gray-500"},[t._v("\n      Տվյալներ չեն գտնվել\n    ")]),t._v(" "),t.selectedFiles.length>0?e("div",{staticClass:"mt-6 sticky bottom-4 flex gap-4"},[e("button",{staticClass:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-md transition-colors",attrs:{disabled:!t.areQuantitiesValid},on:{click:t.submitSelectedFiles}},[t._v("\n        Հաստատել ընտրությունը ("+t._s(t.selectedFiles.length)+")\n      ")]),t._v(" "),e("button",{staticClass:"flex-1 py-3 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-lg shadow-md transition-colors",on:{click:function(e){t.selectedFactory=null}}},[t._v("\n        Ընտրել այլ գործարանից\n      ")])]):t._e()]):e("div",{staticClass:"space-y-4"},[e("h2",{staticClass:"text-xl font-bold text-gray-800 mb-4"},[t._v("Ընտրեք արտադրամաս")]),t._v(" "),e("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},t._l(t.factoriesWithCount,function(n){return e("div",{key:n.id,staticClass:"p-4 border rounded-lg cursor-pointer transition-colors flex items-center justify-between",class:{"hover:border-blue-300":n.fileCount>0,"border-green-200 bg-green-50 hover:bg-green-100":n.fileCount>0,"border-gray-100 bg-gray-50 hover:bg-gray-100":0===n.fileCount,"opacity-60":0===n.fileCount},on:{click:function(e){n.fileCount>0&&t.selectFactory(n)}}},[e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"p-2 rounded-full mr-3",class:{"bg-green-100 text-green-600":n.fileCount>0,"bg-gray-100 text-gray-400":0===n.fileCount}},[e("svg",{staticClass:"h-6 w-6",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"}})])]),t._v(" "),e("div",[e("h3",{staticClass:"font-semibold text-lg"},[t._v(t._s(n.name))]),t._v(" "),e("p",{staticClass:"text-gray-600 text-sm"},[t._v(t._s(n.value))])])]),t._v(" "),e("span",{staticClass:"px-2 py-1 rounded-full text-sm font-medium",class:{"bg-green-100 text-green-800":n.fileCount>0,"bg-gray-100 text-gray-400":0===n.fileCount}},[t._v("\n          "+t._s(n.fileCount)+" ֆայլ\n        ")])])}),0)])])},[],!1,null,"4817113e",null);e.default=component.exports}}]);