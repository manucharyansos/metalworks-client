(window.webpackJsonp=window.webpackJsonp||[]).push([[75,36],{463:function(t,e,r){"use strict";var n=r(3),o=r(282).trim;n({target:"String",proto:!0,forced:r(464)("trim")},{trim:function(){return o(this)}})},464:function(t,e,r){"use strict";var n=r(112).PROPER,o=r(5),l=r(283);t.exports=function(t){return o(function(){return!!l[t]()||"​᠎"!=="​᠎"[t]()||n&&l[t].name!==t})}},532:function(t,e,r){"use strict";r.r(e);r(19),r(42),r(53),r(18),r(60),r(463),r(48),r(46),r(43),r(44),r(113),r(190),r(6),r(23),r(32),r(27),r(26),r(28);function n(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,a){if(t){if("string"==typeof t)return o(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,l=function(){};return{s:l,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,d=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw d}}}}function o(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,r=Array(a);e<a;e++)r[e]=t[e];return r}var l={name:"ProductFormModal",props:{visible:{type:Boolean,default:!1},product:{type:Object,default:null},submitting:{type:Boolean,default:!1}},data:function(){return{MAX_MB:4,GALLERY_MAX:5,form:{name:"",description:"",price:null},errors:{},isDraggingMain:!1,mainFile:null,mainPreview:null,isDraggingGallery:!1,newGallery:[],galleryPreviews:[],existingGallery:[],deletedIds:[]}},computed:{isEdit:function(){return!(!this.product||!this.product.id)},totalGalleryCount:function(){return this.existingGallery.length-this.deletedIds.length+this.newGallery.length},canSubmit:function(){var t=!(!this.mainFile&&!this.mainPreview);return this.form.name.trim()&&this.form.description.trim()&&null!==this.form.price&&Number(this.form.price)>=0&&t&&!this.submitting}},watch:{visible:function(t){document.documentElement.classList.toggle("overflow-hidden",t),t?this.bootstrap():this.resetLocal()}},beforeDestroy:function(){document.documentElement.classList.remove("overflow-hidden")},methods:{bootstrap:function(){var t;(this.errors={},this.isEdit)?(this.form.name=this.product.name||"",this.form.description=this.product.description||"",this.form.price=null!==(t=this.product.price)&&void 0!==t?t:0,this.mainPreview=this.product.image_url||null,this.existingGallery=Array.isArray(this.product.images)?this.product.images.map(function(g){return{id:g.id,url:g.url}}):[]):this.resetLocal()},resetLocal:function(){this.form={name:"",description:"",price:null},this.errors={},this.mainFile=null,this.mainPreview=null,this.isDraggingMain=!1,this.newGallery=[],this.galleryPreviews=[],this.isDraggingGallery=!1,this.existingGallery=[],this.deletedIds=[],this.$refs.mainInput&&(this.$refs.mainInput.value=""),this.$refs.galleryInput&&(this.$refs.galleryInput.value="")},validateImage:function(t){if(!t)return"Պատկեր չի ընտրվել";if(!/image\/(jpeg|jpg|png|webp|gif)/i.test(t.type))return"Ֆայլի տիպը պետք է լինի jpeg/png/webp/gif";var e=1024*this.MAX_MB*1024;return t.size>e?"Պատկերը չպետք է գերազանցի ".concat(this.MAX_MB,"MB"):null},previewFile:function(t,e){var r=new FileReader;r.onload=function(t){return e(t.target.result)},r.readAsDataURL(t)},onMainChange:function(t){var e,r=null===(e=t.target.files)||void 0===e?void 0:e[0];this.addMainImage(r),t.target.value=""},onDropMain:function(t){var e;this.isDraggingMain=!1;var r=null===(e=t.dataTransfer)||void 0===e||null===(e=e.files)||void 0===e?void 0:e[0];this.addMainImage(r)},addMainImage:function(t){var e=this,r=this.validateImage(t);r?this.errors.image=r:(this.mainFile=t,this.previewFile(t,function(t){return e.mainPreview=t}),this.errors.image=null)},clearMainImage:function(){var t;this.mainFile=null,this.isEdit&&null!==(t=this.product)&&void 0!==t&&t.image_url||(this.mainPreview=null)},onGalleryChange:function(t){var e=Array.from(t.target.files||[]);this.addGalleryFiles(e),t.target.value=""},onDropGallery:function(t){var e;this.isDraggingGallery=!1;var r=Array.from((null===(e=t.dataTransfer)||void 0===e?void 0:e.files)||[]);this.addGalleryFiles(r)},addGalleryFiles:function(t){var e=this,r=this.GALLERY_MAX-this.totalGalleryCount;if(r<=0)this.errors.gallery="Առավելագույնը ".concat(this.GALLERY_MAX," պատկեր");else{var o,l=n(t.slice(0,r));try{for(l.s();!(o=l.n()).done;){var d=o.value,c=this.validateImage(d);if(c)return void(this.errors.gallery=c);this.newGallery.push(d),this.previewFile(d,function(t){return e.galleryPreviews.push(t)})}}catch(c){l.e(c)}finally{l.f()}this.errors.gallery=null}},removeNew:function(i){this.newGallery.splice(i,1),this.galleryPreviews.splice(i,1),this.totalGalleryCount<this.GALLERY_MAX&&(this.errors.gallery=null)},toggleDelete:function(t){var i=this.deletedIds.indexOf(t);-1===i?this.deletedIds.push(t):this.deletedIds.splice(i,1)},setMainFromExisting:function(i){var t=this.existingGallery[i];t&&t.url&&(this.mainFile=null,this.mainPreview=t.url)},setMainFromNew:function(i){var t=this.newGallery[i],p=this.galleryPreviews[i];t&&(this.mainFile=t,this.mainPreview=p,this.removeNew(i),this.errors.image=null)},validateForm:function(){this.errors={};var t=!0;return this.form.name.trim()||(this.errors.name="Անունը պարտադիր է",t=!1),this.form.description.trim()||(this.errors.description="Նկարագրությունը պարտադիր է",t=!1),(null==this.form.price||Number(this.form.price)<0)&&(this.errors.price="Արժեքը պետք է լինի 0 կամ ավելի",t=!1),!(!this.mainFile&&!this.mainPreview)||(this.errors.image="Հիմնական պատկերը պարտադիր է",t=!1),this.totalGalleryCount>this.GALLERY_MAX&&(this.errors.gallery="Առավելագույնը ".concat(this.GALLERY_MAX," պատկեր"),t=!1),t},submit:function(){var t;if(this.validateForm()){var e=new FormData;e.append("name",this.form.name),e.append("description",this.form.description),e.append("price",String(this.form.price)),this.mainFile&&e.append("image",this.mainFile),this.newGallery.forEach(function(t,i){return e.append("gallery[".concat(i,"]"),t)}),this.deletedIds.forEach(function(t,i){return e.append("deleted_gallery_images[".concat(i,"]"),t)}),this.$emit("submit",{asFormData:e,isEdit:this.isEdit,id:null===(t=this.product)||void 0===t?void 0:t.id})}}}},d=r(11),component=Object(d.a)(l,function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"fixed inset-0 z-[1100] bg-black/50 flex items-center justify-center p-4 sm:p-6",on:{click:function(e){return e.target!==e.currentTarget?null:t.$emit("close")}}},[e("div",{staticClass:"w-full max-w-2xl bg-white dark:bg-gray-900 rounded-none sm:rounded-2xl shadow-xl h-full sm:h-auto max-h-full sm:max-h-[90vh] flex flex-col",attrs:{role:"dialog","aria-modal":"true"}},[e("div",{staticClass:"sticky top-0 z-10 flex items-center justify-between px-5 py-4 border-b bg-white/90 dark:bg-gray-900/90 backdrop-blur"},[e("h3",{staticClass:"text-lg font-semibold text-gray-900 dark:text-white"},[t._v("\n        "+t._s(t.isEdit?"Խմբագրել ապրանքը":"Ստեղծել նոր ապրանք")+"\n      ")]),t._v(" "),e("button",{staticClass:"rounded-lg p-1 hover:bg-gray-100 dark:hover:bg-gray-800",attrs:{"aria-label":"Փակել մոդալը"},on:{click:function(e){return t.$emit("close")}}},[t._v("\n        ✕\n      ")])]),t._v(" "),e("form",{staticClass:"flex-1 overflow-y-auto px-5 sm:px-6 py-5 space-y-5",attrs:{id:"productForm"},on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",[e("label",{staticClass:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t._v("Անուն *")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.form.name,expression:"form.name",modifiers:{trim:!0}}],staticClass:"mt-1 w-full rounded-lg border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white",class:{"border-red-500":t.errors.name},attrs:{type:"text",disabled:t.submitting,placeholder:"Օր․ «Մետաղական դետալ №5»"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),t.errors.name?e("p",{staticClass:"mt-1 text-sm text-red-600"},[t._v("\n          "+t._s(t.errors.name)+"\n        ")]):t._e()]),t._v(" "),e("div",[e("label",{staticClass:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t._v("Նկարագրություն *")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.form.description,expression:"form.description",modifiers:{trim:!0}}],staticClass:"mt-1 w-full rounded-lg border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white",class:{"border-red-500":t.errors.description},attrs:{rows:"3",disabled:t.submitting,placeholder:"Կարճ նկարագրություն…"},domProps:{value:t.form.description},on:{input:function(e){e.target.composing||t.$set(t.form,"description",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),t.errors.description?e("p",{staticClass:"mt-1 text-sm text-red-600"},[t._v("\n          "+t._s(t.errors.description)+"\n        ")]):t._e()]),t._v(" "),e("div",[e("label",{staticClass:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t._v("Արժեք (֏) *")]),t._v(" "),e("div",{staticClass:"mt-1 relative"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.price,expression:"form.price",modifiers:{number:!0}}],staticClass:"w-full rounded-lg border-gray-300 pr-12 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white",class:{"border-red-500":t.errors.price},attrs:{type:"number",min:"0",step:"1",disabled:t.submitting,placeholder:"Օր․ 120000"},domProps:{value:t.form.price},on:{input:function(e){e.target.composing||t.$set(t.form,"price",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),e("span",{staticClass:"absolute inset-y-0 right-3 flex items-center text-gray-400 select-none"},[t._v("֏")])]),t._v(" "),t.errors.price?e("p",{staticClass:"mt-1 text-sm text-red-600"},[t._v("\n          "+t._s(t.errors.price)+"\n        ")]):t._e()]),t._v(" "),e("div",[e("label",{staticClass:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t._v("Հիմնական պատկեր *")]),t._v(" "),e("div",{staticClass:"mt-2 flex items-center justify-center rounded-xl border-2 border-dashed p-6 text-center transition-colors",class:[t.isDraggingMain?"border-blue-500 bg-blue-50/50 dark:bg-blue-900/10":"border-gray-300 dark:border-gray-700",t.errors.image?"border-red-500":""],on:{dragover:function(e){e.preventDefault(),t.isDraggingMain=!0},dragleave:function(e){e.preventDefault(),t.isDraggingMain=!1},drop:function(e){return e.preventDefault(),t.onDropMain.apply(null,arguments)}}},[t.mainPreview?e("div",{staticClass:"w-full sm:w-auto"},[e("div",{staticClass:"relative inline-block"},[e("img",{staticClass:"w-40 h-40 object-cover rounded-xl border",attrs:{src:t.mainPreview,alt:"Main preview"}}),t._v(" "),e("div",{staticClass:"absolute -top-2 -right-2 flex gap-2"},[e("button",{staticClass:"px-2 py-1 rounded-md bg-white/90 border text-xs hover:bg-white shadow",attrs:{type:"button"},on:{click:function(e){return t.$refs.mainInput.click()}}},[t._v("\n                  Փոխել\n                ")]),t._v(" "),e("button",{staticClass:"px-2 py-1 rounded-md bg-red-600 text-white text-xs hover:bg-red-700 shadow",attrs:{type:"button"},on:{click:t.clearMainImage}},[t._v("\n                  Հեռացնել\n                ")])])])]):e("div",{staticClass:"space-y-2"},[e("p",{staticClass:"text-sm text-gray-600 dark:text-gray-400"},[t._v("\n              Քաշեք & թողեք պատկերը այստեղ կամ\n              "),e("button",{staticClass:"text-blue-600 font-medium hover:underline",attrs:{type:"button"},on:{click:function(e){return t.$refs.mainInput.click()}}},[t._v("\n                ընտրեք ֆայլ\n              ")])]),t._v(" "),e("p",{staticClass:"text-xs text-gray-400"},[t._v("\n              Մինչև "+t._s(t.MAX_MB)+"MB, τύպերը՝ jpeg/png/webp/gif\n            ")]),t._v(" "),e("input",{ref:"mainInput",staticClass:"hidden",attrs:{type:"file",accept:"image/*",disabled:t.submitting},on:{change:t.onMainChange}})])]),t._v(" "),t.errors.image?e("p",{staticClass:"mt-2 text-sm text-red-600"},[t._v("\n          "+t._s(t.errors.image)+"\n        ")]):t._e()]),t._v(" "),e("div",[e("div",{staticClass:"flex items-center justify-between"},[e("label",{staticClass:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t._v("Գալերեայի նկարներ")]),t._v(" "),e("div",{staticClass:"text-xs text-gray-500"},[t._v("\n            "+t._s(t.totalGalleryCount)+"/"+t._s(t.GALLERY_MAX)+"\n          ")])]),t._v(" "),e("div",{staticClass:"mt-2 rounded-xl border-2 border-dashed p-4 transition-colors",class:t.isDraggingGallery?"border-blue-500 bg-blue-50/50 dark:bg-blue-900/10":"border-gray-300 dark:border-gray-700",on:{dragover:function(e){e.preventDefault(),t.isDraggingGallery=!0},dragleave:function(e){e.preventDefault(),t.isDraggingGallery=!1},drop:function(e){return e.preventDefault(),t.onDropGallery.apply(null,arguments)}}},[e("div",{staticClass:"flex flex-wrap gap-3"},[t._l(t.existingGallery,function(img,i){return e("div",{key:"ex-"+img.id,staticClass:"relative group"},[e("img",{staticClass:"w-24 h-24 object-cover rounded-lg border",attrs:{src:img.url}}),t._v(" "),e("div",{staticClass:"absolute -top-2 -right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition"},[e("button",{staticClass:"px-1.5 py-0.5 rounded bg-white text-xs border hover:bg-gray-50 shadow",attrs:{type:"button",title:"Դնել որպես հիմնական"},on:{click:function(e){return t.setMainFromExisting(i)}}},[t._v("\n                  ★\n                ")]),t._v(" "),e("button",{staticClass:"px-1.5 py-0.5 rounded text-white text-xs shadow",class:t.deletedIds.includes(img.id)?"bg-gray-500 hover:bg-gray-600":"bg-red-600 hover:bg-red-700",attrs:{type:"button",title:t.deletedIds.includes(img.id)?"Չեղարկել ջնջումը":"Ջնջել"},on:{click:function(e){return t.toggleDelete(img.id)}}},[t._v("\n                  ×\n                ")])]),t._v(" "),t.deletedIds.includes(img.id)?e("span",{staticClass:"absolute inset-0 bg-red-500/25 rounded-lg border border-red-500 pointer-events-none",attrs:{title:"Will be deleted"}}):t._e()])}),t._v(" "),t._l(t.galleryPreviews,function(p,i){return e("div",{key:"new-"+i,staticClass:"relative group"},[e("img",{staticClass:"w-24 h-24 object-cover rounded-lg border",attrs:{src:p}}),t._v(" "),e("div",{staticClass:"absolute -top-2 -right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition"},[e("button",{staticClass:"px-1.5 py-0.5 rounded bg-white text-xs border hover:bg-gray-50 shadow",attrs:{type:"button",title:"Դնել որպես հիմնական"},on:{click:function(e){return t.setMainFromNew(i)}}},[t._v("\n                  ★\n                ")]),t._v(" "),e("button",{staticClass:"px-1.5 py-0.5 rounded bg-red-600 text-white text-xs hover:bg-red-700 shadow",attrs:{type:"button",title:"Հեռացնել"},on:{click:function(e){return t.removeNew(i)}}},[t._v("\n                  ×\n                ")])])])}),t._v(" "),e("label",{staticClass:"w-24 h-24 flex items-center justify-center border-2 border-dashed rounded-lg cursor-pointer hover:border-blue-500 text-gray-400",class:{"pointer-events-none opacity-40":t.totalGalleryCount>=t.GALLERY_MAX}},[e("span",{staticClass:"text-3xl leading-none"},[t._v("+")]),t._v(" "),e("input",{ref:"galleryInput",staticClass:"hidden",attrs:{type:"file",accept:"image/*",multiple:"",disabled:t.submitting||t.totalGalleryCount>=t.GALLERY_MAX},on:{change:t.onGalleryChange}})])],2),t._v(" "),e("p",{staticClass:"mt-2 text-xs text-gray-400"},[t._v("\n            Առավելագույնը "+t._s(t.GALLERY_MAX)+" պատկեր (յուրաքանչյուրն մինչև\n            "+t._s(t.MAX_MB)+"MB)\n          ")])]),t._v(" "),t.errors.gallery?e("p",{staticClass:"mt-2 text-sm text-red-600"},[t._v("\n          "+t._s(t.errors.gallery)+"\n        ")]):t._e()])]),t._v(" "),e("div",{staticClass:"sticky bottom-0 z-10 px-5 sm:px-6 py-4 border-t bg-white/90 dark:bg-gray-900/90 backdrop-blur flex flex-col sm:flex-row gap-3 justify-end"},[e("button",{staticClass:"px-4 py-2 rounded-lg border hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800",attrs:{type:"button",disabled:t.submitting},on:{click:t.resetLocal}},[t._v("\n        Սկսել զրոյից\n      ")]),t._v(" "),e("button",{staticClass:"px-4 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",attrs:{type:"button",disabled:t.submitting},on:{click:function(e){return t.$emit("close")}}},[t._v("\n        Փակել\n      ")]),t._v(" "),e("button",{staticClass:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-400 inline-flex items-center gap-2",attrs:{type:"submit",form:"productForm",disabled:t.submitting||!t.canSubmit}},[t.submitting?e("svg",{staticClass:"w-4 h-4 animate-spin",attrs:{viewBox:"0 0 24 24",fill:"none"}},[e("circle",{staticClass:"opacity-25",attrs:{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}}),t._v(" "),e("path",{staticClass:"opacity-75",attrs:{fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"}})]):t._e(),t._v(" "),e("span",[t._v(t._s(t.submitting?"Պահպանում…":t.isEdit?"Պահպանել":"Ստեղծել"))])])])])]):t._e()},[],!1,null,null,null);e.default=component.exports},652:function(t,e,r){"use strict";r.r(e);r(18);var n=r(8),o=r(0),l=(r(9),r(80),r(6),r(26),r(79),r(568)),d=r(532),c={components:{ProductTable:l.default,ProductFormModal:d.default},layout:"ManagerLayout",middleware:["manager","roleRedirect"],data:function(){return{products:[],pagination:null,loading:!1,searchQuery:"",debouncedSearch:null,isFormOpen:!1,selectedProduct:null,submitting:!1,confirmDelete:null}},watch:{searchQuery:function(){var t=this;this.debouncedSearch&&clearTimeout(this.debouncedSearch),this.debouncedSearch=setTimeout(function(){return t.loadProducts(1)},400)}},mounted:function(){this.loadProducts(1)},methods:{loadProducts:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark(function r(){var n,o,l,d;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:1,e.loading=!0,r.prev=1,r.next=2,e.$axios.get("/api/products",{params:{page:n,search:e.searchQuery||void 0}});case 2:if(o=r.sent,!0===(null==(l=o.data)?void 0:l.status)){r.next=3;break}throw new Error((null==l?void 0:l.message)||"Server error");case 3:e.products=Array.isArray(l.data)?l.data:[],e.pagination=l.pagination||null,r.next=5;break;case 4:r.prev=4,d=r.catch(1),console.error("Failed to fetch products:",d);case 5:return r.prev=5,e.loading=!1,r.finish(5);case 6:case"end":return r.stop()}},r,null,[[1,4,5,6]])}))()},openCreate:function(){this.selectedProduct=null,this.isFormOpen=!0},openEdit:function(t){this.selectedProduct=t,this.isFormOpen=!0},closeForm:function(){this.isFormOpen=!1,this.selectedProduct=null},handleSubmit:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark(function r(){var o,l,d,c,m,v,f,h,y,x,_;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=t.asFormData,l=t.isEdit,d=t.id,e.submitting=!0,r.prev=1,!l){r.next=4;break}return o instanceof FormData||(m=new FormData,Object.entries(o||{}).forEach(function(t){var e=Object(n.a)(t,2),r=e[0],o=e[1];return m.append(r,o)}),o=m),o.append("_method","PUT"),r.next=2,e.$axios.post("/api/products/".concat(d),o,{headers:{"Content-Type":"multipart/form-data"}});case 2:if(v=r.sent,!0===(null==(f=v.data)?void 0:f.status)){r.next=3;break}throw new Error((null==f?void 0:f.message)||"Update failed");case 3:r.next=6;break;case 4:return r.next=5,e.$axios.post("/api/products",o,{headers:{"Content-Type":"multipart/form-data"}});case 5:if(h=r.sent,!0===(null==(y=h.data)?void 0:y.status)){r.next=6;break}throw new Error((null==y?void 0:y.message)||"Create failed");case 6:return e.closeForm(),r.next=7,e.loadProducts((null===(c=e.pagination)||void 0===c?void 0:c.current_page)||1);case 7:r.next=9;break;case 8:r.prev=8,_=r.catch(1),alert((null===(x=_.response)||void 0===x||null===(x=x.data)||void 0===x?void 0:x.message)||_.message||"Սխալ՝ պահպանման ժամանակ");case 9:return r.prev=9,e.submitting=!1,r.finish(9);case 10:case"end":return r.stop()}},r,null,[[1,8,9,10]])}))()},askDelete:function(t){this.confirmDelete=t},doDelete:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var r,n,o,l,d,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(r=t.confirmDelete)&&void 0!==r&&r.id){e.next=1;break}return e.abrupt("return");case 1:return t.submitting=!0,e.prev=2,e.next=3,t.$axios.delete("/api/products/".concat(t.confirmDelete.id));case 3:if(o=e.sent,!0===(null==(l=o.data)?void 0:l.status)){e.next=4;break}throw new Error((null==l?void 0:l.message)||"Delete failed");case 4:return t.confirmDelete=null,e.next=5,t.loadProducts((null===(n=t.pagination)||void 0===n?void 0:n.current_page)||1);case 5:e.next=7;break;case 6:e.prev=6,c=e.catch(2),alert((null===(d=c.response)||void 0===d||null===(d=d.data)||void 0===d?void 0:d.message)||c.message||"Սխալ՝ ջնջելու ժամանակ");case 7:return e.prev=7,t.submitting=!1,e.finish(7);case 8:case"end":return e.stop()}},e,null,[[2,6,7,8]])}))()}}},m=c,v=r(11),component=Object(v.a)(m,function(){var t,e=this,r=e._self._c;return r("div",{staticClass:"container mx-auto px-4 sm:px-6 lg:px-8 py-8"},[r("div",{staticClass:"flex items-center justify-between mb-6"},[r("h1",{staticClass:"text-xl sm:text-2xl font-semibold"},[e._v("Ապրանքներ")]),e._v(" "),r("button",{staticClass:"inline-flex items-center gap-2 rounded-lg bg-blue-600 text-white px-4 py-2 hover:bg-blue-700",on:{click:e.openCreate}},[r("svg",{staticClass:"w-5 h-5",attrs:{viewBox:"0 0 24 24",fill:"none"}},[r("path",{attrs:{d:"M12 5v14m-7-7h14",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}})]),e._v("\n      Նոր ապրանք\n    ")])]),e._v(" "),r("ProductTable",{attrs:{products:e.products,pagination:e.pagination,"search-query":e.searchQuery},on:{"update:searchQuery":function(t){e.searchQuery=t},"update:search-query":function(t){e.searchQuery=t},"change-page":e.loadProducts,edit:e.openEdit,create:e.openCreate,delete:e.askDelete}}),e._v(" "),r("ProductFormModal",{attrs:{visible:e.isFormOpen,product:e.selectedProduct,submitting:e.submitting},on:{close:e.closeForm,submit:e.handleSubmit}}),e._v(" "),e.confirmDelete?r("div",{staticClass:"fixed inset-0 z-[1000] bg-black/50 flex items-center justify-center p-4",on:{click:function(t){if(t.target!==t.currentTarget)return null;e.confirmDelete=null}}},[r("div",{staticClass:"w-full max-w-md rounded-xl bg-white shadow-xl p-6"},[r("h3",{staticClass:"text-lg font-semibold mb-2"},[e._v("Ջնջե՞լ ապրանքը")]),e._v(" "),r("p",{staticClass:"text-gray-600 mb-6"},[e._v("\n        Դուք պատրաստվում եք ջնջել «"+e._s(null===(t=e.confirmDelete)||void 0===t?void 0:t.name)+"» ապրանքը։\n        Գործողությունը անշրջելի է։\n      ")]),e._v(" "),r("div",{staticClass:"flex justify-end gap-3"},[r("button",{staticClass:"px-4 py-2 rounded-lg border",on:{click:function(t){e.confirmDelete=null}}},[e._v("\n          Չեղարկել\n        ")]),e._v(" "),r("button",{staticClass:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700",attrs:{disabled:e.submitting},on:{click:e.doDelete}},[e._v("\n          "+e._s(e.submitting?"Կատարվում է…":"Ջնջել")+"\n        ")])])])]):e._e()],1)},[],!1,null,null,null);e.default=component.exports;installComponents(component,{ProductTable:r(568).default,ProductFormModal:r(532).default})}}]);