(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{624:function(t,e,r){var content=r(658);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(57).default)("4fbdf7fb",content,!0,{sourceMap:!1})},657:function(t,e,r){"use strict";r(624)},658:function(t,e,r){var n=r(56)(function(i){return i[1]});n.push([t.i,".fade-zoom-enter-active[data-v-712a3062],.fade-zoom-leave-active[data-v-712a3062]{transition:all .18s ease}.fade-zoom-enter[data-v-712a3062],.fade-zoom-leave-to[data-v-712a3062]{opacity:0;transform:scale(.98)}",""]),n.locals={},t.exports=n},711:function(t,e,r){"use strict";r.r(e);r(24),r(43),r(17);var n=r(1),o=r(15),d=(r(9),r(33),r(23),r(403),r(39),r(40),r(27),r(8),r(30),r(18),r(61),r(96));function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach(function(e){Object(o.a)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var v={name:"OrderDetailsModal",components:{FileGallery:r(712).default},props:{visible:{type:Boolean,default:!1},order:{type:Object,default:null}},computed:{number:function(){var t;return null===(t=this.order)||void 0===t||null===(t=t.order_number)||void 0===t?void 0:t.number},code:function(){var t;return null===(t=this.order)||void 0===t||null===(t=t.prefix_code)||void 0===t?void 0:t.code},creatorName:function(){var t,e,r,n;return null!==(t=null===(e=this.order)||void 0===e||null===(e=e.creator)||void 0===e?void 0:e.name)&&void 0!==t?t:"ID: ".concat(null!==(r=null===(n=this.order)||void 0===n?void 0:n.creator_id)&&void 0!==r?r:"—")},finishDate:function(){var t;return(null===(t=this.order)||void 0===t||null===(t=t.dates)||void 0===t?void 0:t.finish_date)||null},isOverdue:function(){if(!this.finishDate)return!1;var t=new Date(this.finishDate),e=new Date;return e.setHours(0,0,0,0),t.setHours(0,0,0,0),t<=e},selectedCount:function(){var t;return((null===(t=this.order)||void 0===t?void 0:t.selected_files)||[]).reduce(function(a,s){return a+(Number(s.quantity)||1)},0)},factoryCount:function(){var t;return((null===(t=this.order)||void 0===t?void 0:t.factory_orders)||[]).reduce(function(t,e){return t+(e.files||[]).reduce(function(b,t){return b+(t.pivot&&Number(t.pivot.quantity)||Number(t.quantity)||1)},0)},0)},totalCount:function(){return this.selectedCount+this.factoryCount},statusBadge:function(){var t,s=((null===(t=this.order)||void 0===t?void 0:t.status)||"").toLowerCase();return"pending"===s?"bg-amber-50 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300":"done"===s||"completed"===s?"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":"canceled"===s?"bg-rose-50 text-rose-700 dark:bg-rose-900/30 dark:text-rose-300":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"}},methods:c(c({},Object(d.b)("factory",["downloadUploadedFile"])),{},{safeDate:function(t){if(!t)return"—";var dt=new Date(t);return isNaN(dt)?t:dt.toLocaleDateString()},safeDateTime:function(t){if(!t)return"—";var dt=new Date(t);return isNaN(dt)?t:dt.toLocaleString()},countFactoryFiles:function(t){return((null==t?void 0:t.files)||[]).reduce(function(b,t){return b+(t.pivot&&Number(t.pivot.quantity)||Number(t.quantity)||1)},0)},publicUrl:function(t){if(!t||"string"!=typeof t)return null;var e=this.$axios.defaults.baseURL;return"".concat(e,"/storage/").concat(t)},isPreviewable:function(t){var p=((null==t?void 0:t.path)||"").toLowerCase(),e=((null==t?void 0:t.original_name)||"").toLowerCase();return/\.pdf$/.test(p)||/\.pdf$/.test(e)||/\.(png|jpe?g|webp|gif)$/.test(p)||/\.(png|jpe?g|webp|gif)$/.test(e)},downloadFile:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark(function r(){var path,n,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,(path=null==t?void 0:t.path)&&"string"==typeof path){r.next=1;break}return r.abrupt("return");case 1:return n=String(path).replace(/\\/g,"/"),r.next=2,e.downloadUploadedFile({path:n,original_name:(null==t?void 0:t.original_name)||"file"});case 2:r.next=4;break;case 3:r.prev=3,o=r.catch(0),e.$notify({text:o,duration:3e3,speed:1e3,position:"top",type:"error"});case 4:case"end":return r.stop()}},r,null,[[0,3]])}))()}})},f=(r(657),r(32)),component=Object(f.a)(v,function(){var t,e,r,n,o,d,l=this,c=l._self._c;return c("transition",{attrs:{name:"fade-zoom"}},[l.visible?c("div",{staticClass:"fixed inset-0 z-50 flex items-center justify-center"},[c("div",{staticClass:"absolute inset-0 bg-black/40",on:{click:function(t){return l.$emit("close")}}}),l._v(" "),c("div",{staticClass:"relative max-h-[90vh] overflow-y-auto w-[95%] max-w-4xl bg-white dark:bg-gray-900 rounded-2xl shadow-2xl p-6",attrs:{role:"dialog","aria-modal":"true"},on:{keydown:function(t){return!t.type.indexOf("key")&&l._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:l.$emit("close")}}},[c("div",{staticClass:"flex items-start justify-between gap-3 mb-4"},[c("div",[c("h3",{staticClass:"text-xl font-semibold text-gray-900 dark:text-gray-100"},[l._v("\n            Պատվեր #"+l._s(l.number||(null===(t=l.order)||void 0===t?void 0:t.id)||"—")+"\n          ")]),l._v(" "),c("p",{staticClass:"text-sm text-gray-500 dark:text-gray-400"},[l.code?c("span",[l._v("Կոդ — "+l._s(l.code))]):l._e()])]),l._v(" "),c("button",{staticClass:"text-gray-500 hover:text-gray-800 dark:hover:text-gray-200 transition",attrs:{"aria-label":"Փակել"},on:{click:function(t){return l.$emit("close")}}},[l._v("\n          ✕\n        ")])]),l._v(" "),c("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},[c("div",{staticClass:"p-4 rounded-xl border border-gray-200 dark:border-gray-800"},[c("div",{staticClass:"text-xs opacity-60 mb-1"},[l._v("Անուն")]),l._v(" "),c("div",{staticClass:"font-medium"},[l._v(l._s((null===(e=l.order)||void 0===e?void 0:e.name)||"—"))])]),l._v(" "),c("div",{staticClass:"p-4 rounded-xl border border-gray-200 dark:border-gray-800"},[c("div",{staticClass:"text-xs opacity-60 mb-1"},[l._v("Ստեղծող")]),l._v(" "),c("div",{staticClass:"font-medium"},[l._v(l._s(l.creatorName))])]),l._v(" "),c("div",{staticClass:"p-4 rounded-xl border border-gray-200 dark:border-gray-800"},[c("div",{staticClass:"text-xs opacity-60 mb-1"},[l._v("Կարգավիճակ")]),l._v(" "),c("span",{staticClass:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium",class:l.statusBadge},[l._v("\n            "+l._s(((null===(r=l.order)||void 0===r?void 0:r.status)||"—").toUpperCase())+"\n          ")])]),l._v(" "),c("div",{staticClass:"p-4 rounded-xl border border-gray-200 dark:border-gray-800"},[c("div",{staticClass:"text-xs opacity-60 mb-1"},[l._v("Ստեղծվել է")]),l._v(" "),c("div",{staticClass:"font-medium"},[l._v(l._s(l.safeDate(null===(n=l.order)||void 0===n?void 0:n.created_at)))])]),l._v(" "),c("div",{staticClass:"p-4 rounded-xl border border-gray-200 dark:border-gray-800 md:col-span-2"},[c("div",{staticClass:"text-xs opacity-60 mb-1"},[l._v("Նկարագրություն")]),l._v(" "),c("div",{staticClass:"whitespace-pre-line"},[l._v("\n            "+l._s((null===(o=l.order)||void 0===o?void 0:o.description)||"—")+"\n          ")])])]),l._v(" "),l.finishDate?c("div",{staticClass:"mb-6"},[c("h4",{staticClass:"text-sm font-semibold mb-2"},[l._v("Ժամանակագրություն")]),l._v(" "),c("ul",{staticClass:"space-y-2"},[c("li",{staticClass:"flex items-start gap-3"},[c("span",{staticClass:"w-2 h-2 rounded-full bg-blue-600 mt-2 animate-ping",class:{"bg-red-500":l.isOverdue,"bg-blue-600 animate-ping":!l.isOverdue}}),l._v(" "),c("div",{staticClass:"flex-1"},[c("div",{staticClass:"text-sm font-medium"},[l._v("Ավարտի պլանային օր")]),l._v(" "),c("div",{staticClass:"text-xs opacity-70"},[l._v("\n                "+l._s(l.safeDateTime(l.finishDate))+"\n              ")])])])])]):l._e(),l._v(" "),c("div",{staticClass:"mb-3 flex flex-wrap items-center gap-2"},[c("span",{staticClass:"text-sm text-gray-600 dark:text-gray-300"},[l._v("Ֆայլերի ամփոփում")]),l._v(" "),c("span",{staticClass:"text-xs px-2 py-1 rounded-full bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300"},[l._v("\n          Ընտրված՝ "+l._s(l.selectedCount)+"\n        ")]),l._v(" "),c("span",{staticClass:"text-xs px-2 py-1 rounded-full bg-indigo-50 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300"},[l._v("\n          Արտադրամասերից՝ "+l._s(l.factoryCount)+"\n        ")]),l._v(" "),c("span",{staticClass:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"},[l._v("\n          Ընդամենը՝ "+l._s(l.totalCount)+"\n        ")])]),l._v(" "),((null===(d=l.order)||void 0===d?void 0:d.factory_orders)||[]).length?c("div",{staticClass:"mb-6"},[c("h4",{staticClass:"text-sm font-semibold mb-2"},[l._v("Արտադրամասեր")]),l._v(" "),c("div",{staticClass:"space-y-4"},l._l(l.order.factory_orders,function(t){var e,r;return c("div",{key:t.id,staticClass:"rounded-xl border border-gray-200 dark:border-gray-800 p-4"},[c("div",{staticClass:"flex items-center justify-between mb-3"},[c("div",[c("div",{staticClass:"text-sm font-semibold"},[l._v("\n                  "+l._s((null===(e=t.factory)||void 0===e?void 0:e.name)||"Արտադրամաս")+"\n                ")]),l._v(" "),c("div",{staticClass:"text-xs mt-1 text-gray-500 dark:text-gray-400"},[l._v("\n                  Կատարող՝\n                  "),c("span",{staticClass:"font-medium"},[l._v("\n                    "+l._s((null===(r=t.operator)||void 0===r?void 0:r.name)||"—")+"\n                  ")])])]),l._v(" "),c("div",{staticClass:"text-xs opacity-70"},[l._v("\n                Ֆայլեր՝ "+l._s(l.countFactoryFiles(t))+"\n              ")])]),l._v(" "),c("FileGallery",{attrs:{items:t.files||[]}})],1)}),0)]):l._e(),l._v(" "),c("div",{staticClass:"mt-6 flex justify-end"},[c("button",{staticClass:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 transition",on:{click:function(t){return l.$emit("close")}}},[l._v("\n          Փակել\n        ")])])])]):l._e(),l._v(" "),c("notifications")],1)},[],!1,null,"712a3062",null);e.default=component.exports}}]);